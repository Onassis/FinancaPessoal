<!DOCTYPE html>
<html xmls:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>Insert title here</title>
<link href="/webjars/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<link href="/webjars/open-iconic/font/css/open-iconic-bootstrap.min.css"
	rel="stylesheet" />
<script src="/webjars/jquery/jquery.min.js"></script>
<script src="/webjars/bootstrap/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script>

	$(document)
			.ready(
					function() {
						console.log("inicio btnEditar")
						//				$("#btn_editar").on("click"), function(e) {
						$(document).delegate(
								'#btn_editar',
								'click',
								function(event) {
									console.log("click btnEditar")
									console.log($(this).attr("href"));
									event.preventDefault();
									$("#myModal").modal("show").find(
											".modal-content").load(
											"http://localhost:8081"
													+ $(this).attr("href"));
								});
						$(document)
								.delegate(
										'#addNew',
										'click',
										function(event) {
											event.preventDefault();
											console.log("click add");
											$("#myModal")
													.modal("show")
													.find(".modal-content")
													.load(
															"http://localhost:8081/favorecido/cadastrar");

										});

						$(document)
								.delegate(
										'#btnSalvar',
										'click',
										function(event) {
											console.log("click btnSalvar")
											event.preventDefault();
											const myForm = document.getElementById('editForm');
											var myData = new FormData(myForm);
											const formJSON = Object
													.fromEntries(myData
															.entries());
											var myJon = JSON.stringify(
													formJSON, null, 2);

											const xhr = new XMLHttpRequest();

											console.log("teste");
											if (document.getElementById('id').value == "")
												xhr.open("post", "/conta")
											else

												var name = $('#name').val();

											$
													.ajax({

														type : "POST",
														contentType : "application/json; charset=utf-8",
														url : "http://localhost:8081/favorecido",
														data : myJon,
														cache : false,
														success : function(
																result) {
															$("#msg")
																	.html(
																			"<span style='color: green'>Company added successfully</span>");
															window
																	.setTimeout(
																			function() {
																				location
																						.reload()
																			},
																			1000)
														},
														error : function(err) {
															$("#msg")
																	.html(
																			"<span style='color: red'>Name is required</span>");
														}
													});
										});
					});
</script>
</head>
<body>
	<p>
		<a class='btn' id='addNew' rel="modal:mymodal">Cria Favorecido</a>
	</p>

	<div class="container">
		<div class="card">
			<table class="table table-hover">
				<thead>
					<tr>
						<th>ID</th>
						<th>Nome</th>
					</tr>
				</thead>

				<tr th:each="f : ${favorecido}">
					<td th:text="${f.id}">1</td>
					<td th:text="${f.nome}">nome</td>
					<td colspan="2"><a id="btn_editar" class="btn btn-info btn-sm"
						th:href="@{/favorecido/editar/{id} (id=${f.id}) }"> <span
							class="oi oi-brush" title="Editar" aria-hidden="true"></span>
					</a>
						<button th:id="${#strings.concat('btn_cargos/excluir/', f.id)  }"
							type="button" class="btn btn-danger btn-sm" data-toggle="modal"
							data-target="#myModal">
							<span class="oi oi-circle-x" title="ExclusÃ£o" aria-hidden="true"></span>
						</button></td>
				</tr>

			</table>
		</div>

		<div class="modal fade" id="myModal">
			<div class="modal-dialog">
				<div class="modal-content"></div>
			</div>
		</div>
	</div>
</body>
</html>